import{_ as s,o as a,c as l,ai as e}from"./chunks/framework.Bm4BMKaq.js";const c=JSON.parse('{"title":"Configuration","description":"","frontmatter":{},"headers":[],"relativePath":"guides/std/config.md","filePath":"guides/std/config.md"}'),n={name:"guides/std/config.md"};function t(h,i,o,p,d,k){return a(),l("div",null,[...i[0]||(i[0]=[e(`<h1 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to “Configuration”">​</a></h1><p>The standard library provides a simple but powerful configuration system built on top of:</p><ul><li>A <code>--config</code> / <code>-c</code> <strong>global option</strong></li><li>A <code>configPlugin</code> that wires the option into your CLI and handles the config file loading, merging and validation</li><li>A set of <strong>services</strong> and <strong>utils</strong> to resolve and merge config files if you need more control</li></ul><p>This page documents how to use it in real CLIs.</p><h2 id="config-plugin-behavior" tabindex="-1">Config Plugin Behavior <a class="header-anchor" href="#config-plugin-behavior" aria-label="Permalink to “Config Plugin Behavior”">​</a></h2><p>The <code>configPlugin</code> provides a simplified configuration system that:</p><ul><li>Loads a single config file using precedence order: explicit (<code>--config</code>) → local (cwd) → global (OS-specific)</li><li>Uses the <strong>first valid file found</strong> (no merging between files)</li><li>If a file is invalid (parse error or validation error), warns and falls back to the next file in precedence order</li><li>If all files are invalid or missing, uses <code>defaultConfig</code> (defaults to <code>{}</code>)</li><li>Merges the matched file config with <code>defaultConfig</code> if provided</li><li>Validates against a schema if provided</li></ul><h3 id="file-lookup-precedence" tabindex="-1">File Lookup Precedence <a class="header-anchor" href="#file-lookup-precedence" aria-label="Permalink to “File Lookup Precedence”">​</a></h3><p>The plugin checks for config files in this order, using the first <strong>valid</strong> one found:</p><ol><li><strong>Explicit path</strong> (via <code>--config</code> / <code>-c</code> option) <ul><li>If invalid, warns and tries local</li></ul></li><li><strong>Local config</strong> (current working directory) <ul><li>Uses <code>defaultFilename</code> if provided, otherwise <code>&lt;cli-name&gt;.config.json</code></li><li>If invalid, warns and tries global</li></ul></li><li><strong>Global config</strong> (OS-specific user config directory) <ul><li>Unix: <code>$XDG_CONFIG_HOME/&lt;cli-name&gt;/config.json</code> or <code>~/.config/&lt;cli-name&gt;/config.json</code></li><li>Windows: <code>%APPDATA%\\\\&lt;cli-name&gt;\\\\config.json</code></li><li>If invalid, warns and uses <code>defaultConfig</code></li></ul></li></ol><p>A file is considered invalid if:</p><ul><li>It cannot be read (permission error)</li><li>It contains invalid JSON</li><li>It fails schema validation (if a schema is provided)</li></ul><h3 id="default-filename" tabindex="-1">Default filename <a class="header-anchor" href="#default-filename" aria-label="Permalink to “Default filename”">​</a></h3><p>By default, the plugin looks for <code>&lt;cli-name&gt;.config.json</code> in the current working directory for the local lookup. You can override this with the <code>defaultFilename</code> option:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">configPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  defaultFilename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tasks.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Uses tasks.json instead of &lt;cli-name&gt;.config.json for local lookup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Note: <code>defaultFilename</code> only affects the local (cwd) lookup, not global or explicit paths.</p><h3 id="explicit-path-config-c" tabindex="-1">Explicit path (<code>--config</code> / <code>-c</code>) <a class="header-anchor" href="#explicit-path-config-c" aria-label="Permalink to “Explicit path (--config / -c)”">​</a></h3><p>You can override the lookup with an explicit path:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">my-cli</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./my-cli.dev.config.json</span></span></code></pre></div><p>When <code>--config</code> is passed, that file is checked first. If it doesn&#39;t exist, the plugin falls back to local, then global.</p><h2 id="low-level-config-resolution-resolveconfig-service" tabindex="-1">Low-Level Config Resolution (resolveConfig service) <a class="header-anchor" href="#low-level-config-resolution-resolveconfig-service" aria-label="Permalink to “Low-Level Config Resolution (resolveConfig service)”">​</a></h2><p>For advanced use cases that need global/local/explicit merging, use the <code>resolveConfig</code> service directly instead of the plugin.</p><p>Config is loaded as JSON from up to three locations, merged in this order (lowest → highest precedence):</p><ol><li><strong>Global config</strong> (user‑ or system‑wide)</li><li><strong>Local config</strong> (project directory)</li><li><strong>Explicit config path</strong> (via <code>--config|-c</code>)</li></ol><h3 id="default-local-path" tabindex="-1">Default local path <a class="header-anchor" href="#default-local-path" aria-label="Permalink to “Default local path”">​</a></h3><ul><li>Local config lives next to where the CLI is usually run: <ul><li>File name: <code>&lt;cli-name&gt;.config.json</code></li><li>Resolved as: <code>getLocalConfigPath(cliName)</code> → <code>$CWD/&lt;cli-name&gt;.config.json</code></li></ul></li></ul><h3 id="default-global-path" tabindex="-1">Default global path <a class="header-anchor" href="#default-global-path" aria-label="Permalink to “Default global path”">​</a></h3><p>Global config is stored in a per‑user config directory:</p><ul><li>On Unix: <ul><li><code>$XDG_CONFIG_HOME/&lt;cli-name&gt;/config.json</code>, or</li><li><code>~/.config/&lt;cli-name&gt;/config.json</code></li></ul></li><li>On Windows: <ul><li><code>%APPDATA%\\\\&lt;cli-name&gt;\\\\config.json</code>, or</li><li><code>&lt;home&gt;\\\\AppData\\\\Roaming\\\\&lt;cli-name&gt;\\\\config.json</code></li></ul></li></ul><p>Resolved via <code>getGlobalConfigPath(cliName)</code>.</p><h2 id="using-the-std-config-option-and-plugin" tabindex="-1">Using the std config option and plugin <a class="header-anchor" href="#using-the-std-config-option-and-plugin" aria-label="Permalink to “Using the std config option and plugin”">​</a></h2><h3 id="adding-the-config-option-manually" tabindex="-1">Adding the config option manually <a class="header-anchor" href="#adding-the-config-option-manually" aria-label="Permalink to “Adding the config option manually”">​</a></h3><p>You can register the std <code>config</code> global option directly:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createCli } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cheloni&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { configOption } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cheloni/std&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cli</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createCli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-cli&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  globalOptions: [configOption],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  command: rootCommand,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="adding-via-configplugin" tabindex="-1">Adding via <code>configPlugin</code> <a class="header-anchor" href="#adding-via-configplugin" aria-label="Permalink to “Adding via configPlugin”">​</a></h3><p>Most CLIs should use the plugin instead of wiring the option manually:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createCli } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cheloni&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { configPlugin } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cheloni/std&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cli</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createCli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-cli&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  version: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  command: rootCommand,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">configPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><code>configPlugin</code>:</p><ul><li>Registers the <code>config</code> global option on the CLI</li><li>Ensures <code>--config</code> / <code>-c</code> is available to all commands</li></ul><h3 id="plugin-options" tabindex="-1">Plugin Options <a class="header-anchor" href="#plugin-options" aria-label="Permalink to “Plugin Options”">​</a></h3><p>You can configure the plugin with several options:</p><h4 id="defaultconfig" tabindex="-1"><code>defaultConfig</code> <a class="header-anchor" href="#defaultconfig" aria-label="Permalink to “defaultConfig”">​</a></h4><p>Provide default configuration that will be merged with any loaded files. File config always takes precedence over defaults:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cli</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createCli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-cli&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  version: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  command: rootCommand,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    configPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      defaultConfig: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        outputDir: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        telemetry: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>If no config file is found, <code>defaultConfig</code> is used (defaults to <code>{}</code> if not provided).</p><h4 id="defaultfilename" tabindex="-1"><code>defaultFilename</code> <a class="header-anchor" href="#defaultfilename" aria-label="Permalink to “defaultFilename”">​</a></h4><p>Override the default config filename pattern. By default, the plugin looks for <code>&lt;cli-name&gt;.config.json</code>:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">configPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  defaultFilename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tasks.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Uses tasks.json instead of &lt;cli-name&gt;.config.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h4 id="schema" tabindex="-1"><code>schema</code> <a class="header-anchor" href="#schema" aria-label="Permalink to “schema”">​</a></h4><p>Validate the merged configuration against a Zod schema:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;zod&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> configSchema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  outputDir: z.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  telemetry: z.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">configPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  schema: configSchema,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  defaultConfig: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    outputDir: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    telemetry: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>If validation fails, a clear error message is thrown with details about what failed.</p><h2 id="what-the-plugin-handler-does" tabindex="-1">What the plugin handler does <a class="header-anchor" href="#what-the-plugin-handler-does" aria-label="Permalink to “What the plugin handler does”">​</a></h2><p>The std <code>configPlugin</code> handler:</p><ul><li>Looks for config files in precedence order (explicit → local → global): <ul><li>Checks explicit path if <code>--config</code> is provided</li><li>If not found or invalid, checks local (cwd) using <code>defaultFilename</code> or <code>&lt;cli-name&gt;.config.json</code></li><li>If not found or invalid, checks global (OS-specific location)</li><li>Uses the <strong>first valid file found</strong> (no merging between files)</li><li>If a file is invalid, warns the user and tries the next file</li><li>If all files are invalid or missing, uses <code>defaultConfig</code></li></ul></li><li>Merges the matched file config with <code>defaultConfig</code>: <ul><li>File config takes precedence over <code>defaultConfig</code></li><li>If no valid file exists, uses <code>defaultConfig</code> (defaults to <code>{}</code>)</li></ul></li><li>Validates against <code>schema</code> if provided: <ul><li>Each file is validated before being used</li><li>If validation fails, warns and tries the next file</li><li>If no file passes validation, validates <code>defaultConfig</code> (throws error if invalid)</li></ul></li><li>Exposes the result on the execution context: <ul><li><code>context.config</code> – merged configuration object (always defined, at least <code>{}</code>)</li><li><code>context.configFiles</code> – array of <code>{ path, scope }</code> describing the loaded file: <ul><li><code>scope</code> is <code>&quot;explicit&quot; | &quot;local&quot; | &quot;global&quot;</code></li></ul></li></ul></li></ul><p>Example handler usage:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> build</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;build&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  handler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> outputDir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cfg?.outputDir </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">??</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;dist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Building into: \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">outputDir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><blockquote><p><strong>Note</strong><br> If you provide a <code>schema</code> option, the config will be validated and typed.<br> Otherwise, treat <code>context.config</code> as <code>unknown</code> and narrow/validate it in user land as needed.</p></blockquote><h2 id="using-the-high‐level-service-directly" tabindex="-1">Using the high‑level service directly <a class="header-anchor" href="#using-the-high‐level-service-directly" aria-label="Permalink to “Using the high‑level service directly”">​</a></h2><p>If you don’t want to rely on the global option handler, you can resolve config manually:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { resolveConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cheloni/std&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">files</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolveConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cli);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// config -&gt; merged global + local config</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// files  -&gt; which files were used and from where</span></span></code></pre></div><p>Or with an explicit path:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolveConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cli, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./my-cli.dev.config.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>This is useful for:</p><ul><li>Custom configuration flows</li><li>CLIs that want to resolve config before parsing args</li></ul><h2 id="low‐level-utilities" tabindex="-1">Low‑level utilities <a class="header-anchor" href="#low‐level-utilities" aria-label="Permalink to “Low‑level utilities”">​</a></h2><p>For advanced use cases, std exports the low‑level helpers from <code>std/utils/config</code>:</p><ul><li><code>getLocalConfigPath(cliName)</code> – compute the default local JSON path</li><li><code>getGlobalConfigPath(cliName)</code> – compute the default global JSON path</li><li><code>loadConfigForCli(cliName, explicitPath?)</code> – read and merge config without a <code>Cli</code> instance <ul><li>Returns <code>{ config, files }</code></li></ul></li></ul><p>These are re‑exported from <code>cheloni/std</code> for convenience.</p>`,69)])])}const g=s(n,[["render",t]]);export{c as __pageData,g as default};
